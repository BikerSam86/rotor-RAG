======================================================================
KV CACHE A/B COMPARISON
======================================================================

[1] Loading model...
======================================================================
Loading BitNet Model
======================================================================
âœ“ Initialized BitNet model:
  - Vocabulary: 128,256
  - Hidden dim: 2560
  - Layers: 30
  - Heads: 20 (KV: 5)
  - FFN dim: 6912

Loading weights from: C:\Users\samho\Desktop\BitNet-2B-model\model.safetensors
  Loading embeddings...
    âœ“ Embeddings: (128256, 2560)
  Loading final norm...
    âœ“ Final norm: (2560,)
  Loading 30 transformer layers...
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
    âœ“ Loaded 5/30 layers...
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
    âœ“ Loaded 10/30 layers...
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
    âœ“ Loaded 15/30 layers...
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
    âœ“ Loaded 20/30 layers...
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
    âœ“ Loaded 25/30 layers...
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
    âœ“ Loaded 30/30 layers...
  âœ“ All layers loaded!

âœ“ Model weights loaded successfully!
  Total transformer layers: 30
  All ternary weights converted to Rotor format!

======================================================================
âœ“ BitNet model loaded successfully!
======================================================================
Ready for inference with 30 layers!
All ternary weights in optimized Rotor format!
======================================================================

[2] Loading tokenizer...
âœ“ Tokenizer loaded:
  Vocabulary size: 128,256
  BOS token: '<|begin_of_text|>' (ID: 128000)
  EOS token: '<|end_of_text|>' (ID: 128001)
  PAD token: '<pad>' (ID: 8085)

Prompt: 'The future of AI' (5 tokens)

======================================================================
TEST A: Token 2 WITHOUT cache (recompute 6 tokens)
======================================================================
Processing 6 tokens (full sequence)...
Time WITHOUT cache: 283.9s
Generated token: 78212

======================================================================
TEST B: Token 2 WITH cache (process 1 new token)
======================================================================
Step 1: Processing prompt to build cache...
  Cache built in 248.3s, generated token: 78212
Step 2: Using cache to generate token 2...
Time WITH cache: 105.2s
Generated token: 78212

======================================================================
RESULTS
======================================================================

Generating Token 2:
  WITHOUT cache (6 tokens): 283.9s
  WITH cache    (1 token):  105.2s

  âœ… Speedup: 2.70Ã—
  âœ… KV cache is 2.7Ã— FASTER!

======================================================================
ANALYSIS
======================================================================
Expected speedup: ~1.5-2Ã— for short sequences
(Cache saves recomputing Q,K,V for past tokens)

ðŸŒ€ All ways, always!
