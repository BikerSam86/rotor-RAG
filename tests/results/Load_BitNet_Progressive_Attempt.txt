Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6

PS C:\Users\samho\Desktop\rotor-rag-code\examples> python load_bitnet_progressive.py

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          Progressive BitNet Model Loader                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Loading FULL model with all 30 layers...
(Fast C library: ~20 seconds instead of 111 minutes!)

Loading full model with optimized C conversion...

======================================================================
Progressive BitNet Model Loading
======================================================================

Model config:
  Vocabulary: 128,256
  Hidden dim: 2560
  Layers to load: 30
  Heads: 20 (KV: 5)
  FFN dim: 6912
âœ“ Initialized BitNet model:
  - Vocabulary: 128,256
  - Hidden dim: 2560
  - Layers: 30
  - Heads: 20 (KV: 5)
  - FFN dim: 6912

======================================================================
Loading weights from: model.safetensors
======================================================================

[1/3] Loading embeddings...
      âœ“ Embeddings loaded: (128256, 2560)

[2/3] Loading final normalization...
      âœ“ Final norm loaded: (2560,)

[3/3] Loading 30 transformer layers...
      (Converting BitNet â†’ Rotor format)

  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [ 1/30] Layer 0 loaded in 186.98s (3.3% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [ 2/30] Layer 1 loaded in 215.78s (6.7% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [ 3/30] Layer 2 loaded in 189.88s (10.0% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [ 4/30] Layer 3 loaded in 186.68s (13.3% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [ 5/30] Layer 4 loaded in 212.78s (16.7% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [ 6/30] Layer 5 loaded in 192.40s (20.0% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [ 7/30] Layer 6 loaded in 190.19s (23.3% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [ 8/30] Layer 7 loaded in 192.29s (26.7% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [ 9/30] Layer 8 loaded in 187.47s (30.0% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [10/30] Layer 9 loaded in 191.40s (33.3% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [11/30] Layer 10 loaded in 189.19s (36.7% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [12/30] Layer 11 loaded in 184.57s (40.0% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [13/30] Layer 12 loaded in 183.09s (43.3% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [14/30] Layer 13 loaded in 184.21s (46.7% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [15/30] Layer 14 loaded in 180.53s (50.0% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [16/30] Layer 15 loaded in 181.08s (53.3% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [17/30] Layer 16 loaded in 181.93s (56.7% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [18/30] Layer 17 loaded in 187.94s (60.0% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [19/30] Layer 18 loaded in 180.31s (63.3% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [20/30] Layer 19 loaded in 182.83s (66.7% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [21/30] Layer 20 loaded in 237.42s (70.0% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [22/30] Layer 21 loaded in 286.59s (73.3% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [23/30] Layer 22 loaded in 500.48s (76.7% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [24/30] Layer 23 loaded in 260.18s (80.0% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [25/30] Layer 24 loaded in 187.95s (83.3% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [26/30] Layer 25 loaded in 187.43s (86.7% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [27/30] Layer 26 loaded in 184.38s (90.0% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [28/30] Layer 27 loaded in 183.30s (93.3% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [29/30] Layer 28 loaded in 186.70s (96.7% complete)
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (640x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (6912x2560)...
  âœ“ Weights cached
  Caching decoded weights (2560x6912)...
  âœ“ Weights cached
      [30/30] Layer 29 loaded in 180.66s (100.0% complete)
C:\Users\samho\Desktop\rotor-rag-code\src\rotor\transformer.py:301: RuntimeWarning: overflow encountered in exp
  return x / (1 + np.exp(-x))

======================================================================
âœ“ Model loading complete!
======================================================================

âœ“ Total loading time: 6192.33s

======================================================================
Testing Forward Pass
======================================================================

Input: [1 2 3 4 5]

âœ“ Forward pass complete!
  Time: 261711.32 ms
  Output shape: (5, 128256)
  Expected: (5, 128256)

======================================================================
ðŸŽ‰ SUCCESS! FULL MODEL LOADED!
======================================================================

âœ“ Loaded ALL 30 transformer layers
âœ“ All ternary weights converted to Rotor format (using fast C library)
âœ“ Forward pass working: 261711.32 ms
âœ“ Total load time: 6192.33s

ðŸš€ Full 2.4B parameter model ready for inference!
   Model size: 2.4 billion ternary weights
   Memory usage: ~1.1GB (ternary compressed)
   Conversion speedup: 275Ã— with C library

ðŸŒ€ All ways, always!
======================================================================

PS C:\Users\samho\Desktop\rotor-rag-code\examples>
