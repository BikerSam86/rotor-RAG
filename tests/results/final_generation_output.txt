======================================================================
BitNet Text Generation Demo
======================================================================

[1] Loading tokenizer...
----------------------------------------------------------------------
✓ Tokenizer loaded:
  Vocabulary size: 128,256
  BOS token: '<|begin_of_text|>' (ID: 128000)
  EOS token: '<|end_of_text|>' (ID: 128001)
  PAD token: '<pad>' (ID: 8085)
✓ Tokenizer loaded in 1.31s

[2] Loading BitNet model...
----------------------------------------------------------------------
This will take about 78 seconds with C optimizations...
✓ Initialized BitNet model:
  - Vocabulary: 128,256
  - Hidden dim: 2560
  - Layers: 30
  - Heads: 20 (KV: 5)
  - FFN dim: 6912

Loading weights from: C:\Users\samho\Desktop\BitNet-2B-model\model.safetensors
  Loading embeddings...
    ✓ Embeddings: (128256, 2560)
  Loading final norm...
    ✓ Final norm: (2560,)
  Loading 30 transformer layers...
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
    ✓ Loaded 5/30 layers...
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
    ✓ Loaded 10/30 layers...
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...
  ✓ Weights cached
    ✓ Loaded 15/30 layers...
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (640x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (6912x2560)...
  ✓ Weights cached
  Caching decoded weights (2560x6912)...